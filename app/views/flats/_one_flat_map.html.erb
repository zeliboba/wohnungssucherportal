<div id="map">
  <script type="text/javascript">
    function initialize() {
    
        // set up new map
        var mapOptions = {
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    
        var geocoder = new google.maps.Geocoder();
    
        centerMap(map, geocoder);
        <% ref_points = [amazon_muenchen, xenia_muenchen, circulo_salsa_muenchen] %>
        addReferencePoints(map, geocoder, <%=raw ref_points.to_json %>);
    
        var address = '<%= flat.full_address %>';
    
        var markerOptions = {
            'position': new google.maps.LatLng(<%= flat.latitude %>, <%= flat.longitude %>),
            'title': address,
            'map': map
        };
        var marker = new google.maps.Marker(markerOptions);
    }
  </script>
    
    <div id="map_canvas" style="width: 800px; height: 600px; border: 1px solid #000"></div>
</div>